<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>无人机位置</title>


    <link href="${s.base}/res/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
    <script src="${s.base}/media/js/jquery-1.10.1.min.js" type="text/javascript"></script>
    <link rel="icon" type="image/png" href="${s.base}/i/ico.png" sizes="16x16">
    <!-- BEGIN PAGE LEVEL STYLES -->
	<link rel="stylesheet" href="http://cache.amap.com/lbs/static/main1119.css" />
    <script src="http://cache.amap.com/lbs/static/es5.min.js"></script>
    <script type="text/javascript" src='//webapi.amap.com/maps?v=1.4.6&key=82f9e75505b649be9ab81a45ae34aa14'></script>
    <script type="text/javascript" src="http://cache.amap.com/lbs/static/addToolbar.js"></script>
</head>
<style>
.headerUav{
  position:absolute;
  z-index:99;
  width:400px;;
  height:50px;
  margin:0 auto;
  text-align:center;
  background-color:red;
  left:50%;
  line-height:50px;
  transform: translate(-50%, 0);
  border-radius:10px;
  -moz-border-radius:10px; /* 老的 Firefox */
  opacity:0.7;
  color:#fff;
  margin-top:20px;
}
#UavInfo{
    position:absolute;
    z-index:99;
    width:360px;
    min-height: 420px;
    right:2%;
    background-color:#fff;
    border-radius:10px;
    -moz-border-radius:10px; /* 老的 Firefox */
    opacity:0.8;
    color:#f01414;
    margin-top:2%;
    padding: 25px;
    font-size:1.6rem;
}
.liheader{
    background-color:#d4d4d4;
}
</style>
<body>
<div class="headerUav" style="font-size:2.0rem;">
飞机状态：飞行中
</div>
<div id="UavInfo">
    <div class="baseInfo">

        <ul class="list-group">
            <li class="list-group-item liheader" ><b>任务基本信息</b></li>
            <li class="list-group-item" >巡检任务名称：<span id="taskName">${task.name}</span></li>
            <li class="list-group-item" >飞行路径名称：<span id="flyingPathName"></span></li>
            <li class="list-group-item">起飞员：<span>${task.userAName}</span></li>
            <li class="list-group-item">降落员：<span>${task.userZName}</span></li>
            <li class="list-group-item" >无人机设备号：<span id="uavDeviceId"></span></li>
            <li class="list-group-item" >无人机名称：<span id="uavName"></span></li>
            <li class="list-group-item" >无人机描述：<span id="uavDescription"></span></li>
        </ul>
    </div>
    <div class="flyingInfo">
        <ul class="list-group">
            <li class="list-group-item liheader"><b>无人机信息</b></li>
            <li class="list-group-item">无人机位置：</li>
            <li class="list-group-item">无人机状态：</li>
            <li class="list-group-item">无人机高度：</li>
            </ul>
    </div>
</div>
<div id="container"></div>
           
        <!-- UI组件库 1.0 -->
        <script src="//webapi.amap.com/ui/1.0/main.js?v=1.0.11"></script>
        <script type="text/javascript">
           
			var uavdata = ${uav};
			var flyingPath = ${path};

			$("#flyingPathName").html(flyingPath.name);

            $("#uavDeviceId").html(uavdata.deviceid);
            $("#uavName").html(uavdata.name);
            $("#uavDescription").html(uavdata.description);


            //创建地图
            var map = new AMap.Map('container', {
                zoom: 12,
                center: flyingPath.pathdata[0], //中心点坐标
            });
            map.plugin(["AMap.Scale"],function(){    //加载比例尺插件      
     	       var scale = new AMap.Scale({
     	        visible: true,
     			position:'LB',
     			}); 
     	        map.addControl(scale);  
     	        scale.show();
     	 	});

            var polyline = new AMap.Polyline({
                map: map,
                path: flyingPath.pathdata, //设置线覆盖物路径
                strokeColor: '#ff6700', //线颜色
                strokeOpacity: 1, //线透明度
                strokeWeight: 6, //线宽
                strokeStyle: "solid", //线样式
                strokeDasharray: [10, 5] //补充线样式
            });

	        var uavMarker = new AMap.Marker({
	                map: map,
                    position: uavdata.position,
                    icon: new AMap.Icon({
                        size: new AMap.Size(32, 32), //图标大小
                        image: 'i/fly-32.png',
                        offset: new AMap.Pixel(-16, -16) // 相对于基点的偏移位置
                    }),
             });
	        
	        
	        
	        //然后在下面进行位置轮询
	  			  	        

		        /* var infoWindow = new AMap.InfoWindow({
	            isCustom: true,
	            offset: new AMap.Pixel(20, -25)
	            }); */
                //实例化信息窗体
               /*  var title = '无人机编号:<span>' + data[i].name + '</span>';
                var content = [];
                content.push("状态：" + statusDec);
                content.push("描述：" + data[i].description);
                content.push("创建时间：" + data[i].updatetime);

                markeritem.content = createInfoWindow(title, content.join("<br/>"));
                markeritem.on('click', markerClick);

                markerlist[data[i].status].push(markeritem);
            } */

            /* function markerClick(e) {
                infoWindow.setContent(e.target.content);
                infoWindow.open(map, e.target.getPosition());
            }


            //选中无人机类型进行显示,并且展示相关列表
            function showplane(index) {
            	
                var disRouteCheckbox = document.getElementById("optionsRadios" + index);
                if (disRouteCheckbox.checked == true) {
                    map.add(markerlist[statuscode[index]]);

                } else {
                    map.remove(markerlist[statuscode[index]]);
                }
                document.getElementById("my-list").innerHTML = "";
                var flaglist = [];
                var innHTML = "";
                for (var i = 0; i < 4; i++) {
                    var checkfg = document.getElementById("optionsRadios" + i);
                    if (checkfg.checked == true) {
                        flaglist.push(i);
                    }
                }
               
                for (var j = 0; j < data.length; j++) {

                    if (flaglist.indexOf(data[j].status) >= 0) {
                        var str = '<li class="poibox" onclick="showPlan(' + 'this,' + data[j].position + ')">无人机编号：'
                        + data[j].name + '&nbsp;&nbsp;状态：' + Statusdec[data[j].status] 
                        + '<br>更新时间：' + data[j].updatetime 
                        + '<br>描述：' + data[j].description 
                        + '<br>SIM卡1：' + data[j].phoneone
                        + '<br>SIM卡2：' + data[j].phonetwo
                        + '</li>';
                       
                        innHTML = innHTML + str;
                    }
                }

                document.getElementById("my-list").innerHTML = innHTML;
            }


            function showPlan(e, positionX, positionY) {
                var posi = [positionX, positionY];
                var lilist = document.getElementById('my-list')
                var eles = lilist.getElementsByTagName('li');
                
                for(var i=0;i<eles.length;i++){
                	
                	eles[i].className = 'poibox';
                }
                e.className ='poibox selected';
                       
                map.panTo(posi);
            }

          
            //构建自定义信息窗体
            function createInfoWindow(title, content) {
                var info = document.createElement("div");
                info.className = "info";

                //可以通过下面的方式修改自定义窗体的宽高
                info.style.width = "240px";
                // 定义顶部标题
                var top = document.createElement("div");
                var titleD = document.createElement("div");
                var closeX = document.createElement("img");
                top.className = "info-top";
                titleD.innerHTML = title;
                closeX.src = "res/i/close2.gif";
                closeX.onclick = closeInfoWindow;

                top.appendChild(titleD);
                top.appendChild(closeX);
                info.appendChild(top);

                // 定义中部内容
                var middle = document.createElement("div");
                middle.className = "info-middle";
                middle.style.backgroundColor = 'white';
                middle.innerHTML = content;
                info.appendChild(middle);
                return info;
            }

            //关闭信息窗体
            function closeInfoWindow() {
                map.clearInfoWindow();
            } */
           
        </script>
 		</div>
	</body>
</html>